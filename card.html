<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/card.css">
    <link rel="icon" type="image" href="./icon/logoWhite.png">
    <script src="https://kit.fontawesome.com/15e164fb66.js" crossorigin="anonymous"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&family=Roboto:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />

    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


    <title>Construções Coutinho</title>
</head>
<body>

    
<div class="conteudo">

    <main>
    <div class="cardContainer">
        <section class="container">
            <div class="slider-weapper">
                <div class="slider">
                    <img id="slider-1" src="img/service-slide1.png" alt="image 1"/>
                    <img id="slider-2" src="img/service-slide2.jpg" alt="image 2"/>
                    <img id="slider-3" src="img/service-slide3.jpg" alt="image 3"/>
    
                </div>
                <div class="slider-nav">
                    <a href="#slide-1"></a>
                    <a href="#slide-2"></a>
                    <a href="#slide-3"></a>
                </div>
            </div>
               
        </section>
        <div class="text">
        <h3>Cha de Alecrim</h3>
        <p>-Construcao<br>
           -Remodelacao<br>
           -Rede Hidrosanitaria</p>
        </div>   

    </div>

    <div class="cardContainer">
        <section class="container">
            <div class="slider-weapper">
                <div class="slider">
                    <img id="slider-1" src="img/service-slide1.png" alt="image 1"/>
                    <img id="slider-2" src="img/service-slide2.jpg" alt="image 2"/>
                    <img id="slider-3" src="img/service-slide3.jpg" alt="image 3"/>
    
                </div>
                <div class="slider-nav">
                    <a href="#slide-1"></a>
                    <a href="#slide-2"></a>
                    <a href="#slide-3"></a>
                </div>
            </div>
               
        </section>
        <div class="text">
        <h3>Cha de Alecrim</h3>
        <p>-Construcao<br>
           -Remodelacao<br>
           -Rede Hidrosanitaria</p>
        </div>   

    </div>

    <div class="cardContainer">
        <section class="container">
            <div class="slider-weapper">
                <div class="slider">
                    <img id="slider-1" src="img/service-slide1.png" alt="image 1"/>
                    <img id="slider-2" src="img/service-slide2.jpg" alt="image 2"/>
                    <img id="slider-3" src="img/service-slide3.jpg" alt="image 3"/>
    
                </div>
                <div class="slider-nav">
                    <a href="#slide-1"></a>
                    <a href="#slide-2"></a>
                    <a href="#slide-3"></a>
                </div>
            </div>
               
        </section>
        <div class="text">
        <h3>Cha de Alecrim</h3>
        <p>-Construcao<br>
           -Remodelacao<br>
           -Rede Hidrosanitaria</p>
        </div>   

    </div>

</main>



<h1 class="title">Foto Galeria</h1>


    <div class="gallery-wrap">
        <img src="img/Galeria/back.png" id="backBtn">
   
    <div class="gallery" id="galleryContainer">
        <!-- Cada DIV é um “slide” -->
        <div><img src="img/Galeria/1.jpg" alt="Imagem 1"></div>
        <div><img src="img/Galeria/2.jpg" alt="Imagem 2"></div>
        <div><img src="img/Galeria/3.jpg" alt="Imagem 3"></div>
        <div><img src="img/Galeria/4.jpg" alt="Imagem 4"></div>
        <div><img src="img/Galeria/5.jpg" alt="Imagem 5"></div>
        <div><img src="img/Galeria/6.jpg" alt="Imagem 6"></div>
        <div><img src="img/Galeria/7.jpg" alt="Imagem 7"></div>
        <div><img src="img/Galeria/8.jpg" alt="Imagem 8"></div>
        <div><img src="img/Galeria/9.jpg" alt="Imagem 9"></div>
      </div>
  
        <img src="img/Galeria/next.png" id="nextBtn">      
     </div>  

     <!-- Modal para ver a imagem ampliada -->
    <div class="modal" id="modal">
        <!-- Ícone de fechar -->
        <span class="close" id="closeModal">&times;</span>
        <!-- Imagem ampliada -->
        <img class="modal-content" id="modalImg">
        <!-- Ícones de navegação dentro da modal -->
        <div class="modal-nav">
        <span id="modalPrev">&#10094;</span>
        <span id="modalNext">&#10095;</span>
        </div>
    </div>

    <div class="slider-indicators" id="sliderIndicators">
        <!-- Os dots serão gerados dinamicamente -->
      </div>

      <h2>Avalie nosso serviço</h2>
      <div class="stars" id="starContainer">
        <!-- Ícones de estrela, você pode usar FontAwesome, Emoji ou SVG -->
        <span class="star" data-value="1">&#9733;</span>
        <span class="star" data-value="2">&#9733;</span>
        <span class="star" data-value="3">&#9733;</span>
        <span class="star" data-value="4">&#9733;</span>
        <span class="star" data-value="5">&#9733;</span>
      </div>
      


  
</body>

<script>
     // ---------- Scroll horizontal na galeria ----------
  const galleryContainer = document.getElementById('galleryContainer');
  const backBtn = document.getElementById('backBtn');
  const nextBtn = document.getElementById('nextBtn');

  backBtn.addEventListener('click', () => {
    galleryContainer.scrollLeft -= galleryContainer.clientWidth;
  });

  nextBtn.addEventListener('click', () => {
    galleryContainer.scrollLeft += galleryContainer.clientWidth;
  });

    // ---------- Auto-slide a cada 3 segundos ----------
    setInterval(() => {
    // Se estivermos próximos do fim, volta para o início
    const slideWidth = getSlideWidth();
    let index = Math.round(galleryContainer.scrollLeft / slideWidth);
    if (index >= slides.length - 1) {
      galleryContainer.scrollLeft = 0;
    } else {
      if (window.innerWidth > 750) {
        // MODO PC (> 750px): avança 1 imagem
        // cada imagem tem largura (80vw / 3), então:
        galleryContainer.scrollLeft += (galleryContainer.clientWidth / 3);
      } else {
        // MODO MOBILE (<= 750px): avança 1 imagem (tela inteira)
        galleryContainer.scrollLeft += galleryContainer.clientWidth;
      }
    }
    updateSliderDots();
  }, 3000); // 3 segundos

   // Atualiza os dots quando há rolagem manual
   galleryContainer.addEventListener('scroll', () => {
    updateSliderDots();
  });

  // Retorna a largura de um slide dependendo do dispositivo
  function getSlideWidth() {
    return window.innerWidth > 750 ? galleryContainer.clientWidth / 3 : galleryContainer.clientWidth;
  }

  // Gera os indicadores de acordo com o número de slides
  const sliderIndicators = document.getElementById('sliderIndicators');
  const slides = document.querySelectorAll('.gallery > div');
  slides.forEach((slide, index) => {
    const dot = document.createElement('div');
    dot.classList.add('dot');
    dot.addEventListener('click', () => {
      galleryContainer.scrollLeft = index * getSlideWidth();
      updateSliderDots();
    });
    sliderIndicators.appendChild(dot);
  });

  // Atualiza o indicador ativo conforme o slide atual
  function updateSliderDots() {
    const slideWidth = getSlideWidth();
    let index = Math.round(galleryContainer.scrollLeft / slideWidth);
    if (index >= slides.length) index = slides.length - 1;
    document.querySelectorAll('.slider-indicators .dot').forEach((dot, idx) => {
      dot.classList.toggle('active', idx === index);
    });
  }
  // Inicializa os indicadores
  updateSliderDots();

  // ---------- Modal (imagem ampliada) ----------
  const modal = document.getElementById('modal');
  const modalImg = document.getElementById('modalImg');
  const closeModal = document.getElementById('closeModal');
  const modalPrev = document.getElementById('modalPrev');
  const modalNext = document.getElementById('modalNext');

  // Seleciona todas as imagens da galeria
  const allImages = document.querySelectorAll('.gallery img');

  // Índice da imagem atualmente exibida na modal
  let currentIndex = 0;

  // Ao clicar em qualquer imagem, abre a modal
  allImages.forEach((img, index) => {
    img.addEventListener('click', () => {
      currentIndex = index;
      openModal(currentIndex);
    });
  });

  // Função para abrir a modal com a imagem no índice 'i'
  function openModal(i) {
    modal.style.display = 'flex';       // mostra a modal
    modalImg.src = allImages[i].src;    // define o src da imagem ampliada
  }

  // Fechar a modal ao clicar no (X)
  closeModal.addEventListener('click', () => {
    modal.style.display = 'none';
  });

  // Botão "Próxima" dentro da modal
  modalNext.addEventListener('click', () => {
    currentIndex++;
    if (currentIndex >= allImages.length) {
      currentIndex = 0; // volta para a primeira, se quiser looping
    }
    modalImg.src = allImages[currentIndex].src;
  });

  // Botão "Anterior" dentro da modal
  modalPrev.addEventListener('click', () => {
    currentIndex--;
    if (currentIndex < 0) {
      currentIndex = allImages.length - 1; // vai para a última, se quiser looping
    }
    modalImg.src = allImages[currentIndex].src;
  });

  // Fecha a modal se o usuário clicar fora da imagem
  window.addEventListener('click', (e) => {
    if (e.target === modal) {
      modal.style.display = 'none';
    }
  });
</script>

<!-- Script do Google One Tap -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<!-- Firebase App (core) -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<!-- Firebase Firestore -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<script>
  // 1. Configuração do Firebase (substitua com suas credenciais)
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "seu-projeto.firebaseapp.com",
    projectId: "seu-projeto",
    storageBucket: "seu-projeto.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // 2. Variável para armazenar o token do Google One Tap
  let googleCredential = null;

  // 3. Configuração do Google One Tap
  window.onload = function() {
    google.accounts.id.initialize({
      client_id: 'SEU_CLIENT_ID_GOOGLE.apps.googleusercontent.com',
      callback: handleCredentialResponse,
      auto_select: true
    });
    // Exibe o One Tap (apenas se necessário)
    google.accounts.id.prompt();
  };

  function handleCredentialResponse(response) {
    // Aqui você recebe o JWT da conta Google
    googleCredential = response.credential;
    console.log("Usuário autenticado com Google One Tap");
    // Você pode decodificar o token se precisar de informações do usuário
  }

  // 4. Lógica do widget de avaliação com estrelas
  const stars = document.querySelectorAll('.star');
  stars.forEach(star => {
    star.addEventListener('click', () => {
      const rating = parseInt(star.getAttribute('data-value'));
      // Atualiza a interface
      stars.forEach(s => {
        if (parseInt(s.getAttribute('data-value')) <= rating) {
          s.classList.add('selected');
        } else {
          s.classList.remove('selected');
        }
      });
      // Se o usuário não estiver autenticado, acione o One Tap
      if (!googleCredential) {
        google.accounts.id.prompt(); // Exibe o One Tap novamente
        return; // Aguarda a autenticação para enviar a avaliação
      }
      // Envie a avaliação para o Firebase Firestore
      db.collection('avaliacoes').add({
        rating: rating,
        googleCredential: googleCredential, // Armazene o token ou um hash dele
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        alert("Obrigado por sua avaliação!");
      }).catch((error) => {
        console.error("Erro ao salvar avaliação: ", error);
      });
    });
  });
</script>

</html>